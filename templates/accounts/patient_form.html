{% extends "base.html" %}
{% block title %}Crear paciente | Clínica{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-12 col-lg-7">

    <div class="card shadow-sm border-0">
      <div class="card-body p-4 p-md-5">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div>
            <h1 class="h4 fw-bold mb-1">Crear paciente</h1>
            <div class="text-muted">Crea el usuario + perfil del paciente</div>
          </div>
          <a href="{% url 'my_appointments' %}" class="btn btn-outline-secondary btn-sm">Volver</a>
        </div>

        {% if form.non_field_errors %}
          <div class="alert alert-danger">
            {{ form.non_field_errors }}
          </div>
        {% endif %}

        <form method="post" novalidate>
          {% csrf_token %}

          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Usuario</label>
              {{ form.username }}
              {% if form.username.errors %}<div class="text-danger small">{{ form.username.errors }}</div>{% endif %}
            </div>

            <div class="col-md-6">
              <label class="form-label">Email</label>
              {{ form.email }}
              {% if form.email.errors %}<div class="text-danger small">{{ form.email.errors }}</div>{% endif %}
            </div>

            <div class="col-md-6">
              <label class="form-label">Nombre</label>
              {{ form.first_name }}
            </div>

            <div class="col-md-6">
              <label class="form-label">Apellido</label>
              {{ form.last_name }}
            </div>

            <div class="col-md-6">
              <label class="form-label">Contraseña</label>
              {{ form.password1 }}
              {% if form.password1.errors %}<div class="text-danger small">{{ form.password1.errors }}</div>{% endif %}
            </div>

            <div class="col-md-6">
              <label class="form-label">Confirmar contraseña</label>
              {{ form.password2 }}
              {% if form.password2.errors %}<div class="text-danger small">{{ form.password2.errors }}</div>{% endif %}
            </div>

            <hr class="my-2">

            <div class="col-md-6">
              <label class="form-label">Teléfono</label>
              {{ form.phone }}
            </div>

            <div class="col-md-6">
              <label class="form-label">Fecha de nacimiento</label>
              {{ form.birth_date }}
            </div>

            <div class="col-12">
              <label class="form-label">Dirección</label>
              {{ form.address }}
            </div>
          </div>

          <div class="d-grid mt-4">
            <button class="btn btn-dark btn-lg" type="submit">Crear paciente</button>
          </div>
        </form>
      </div>
    </div>

  </div>
</div>

<script>
  (function () {
    document.querySelectorAll("input, textarea, select").forEach(el => {
      if (!el.classList.contains("form-control") && !el.classList.contains("form-check-input")) {
        el.classList.add("form-control");
      }
    });
  })();
</script>
{% endblock %}
